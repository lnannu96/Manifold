2020-09-07 11:04:48.491039: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
/usr/local/lib/python3.8/dist-packages/tensorflow/python/autograph/utils/testing.py:21: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
2020-09-07 11:05:45.668697: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-07 11:05:47.486656: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.486972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce GTX 1070 with Max-Q Design computeCapability: 6.1
coreClock: 1.2655GHz coreCount: 16 deviceMemorySize: 7.93GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-07 11:05:47.487009: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-09-07 11:05:47.488425: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-09-07 11:05:47.489318: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-07 11:05:47.489621: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-07 11:05:47.490839: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-07 11:05:47.491897: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-09-07 11:05:47.494601: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-09-07 11:05:47.494798: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.495207: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.495520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-07 11:05:47.495879: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-07 11:05:47.520058: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2199995000 Hz
2020-09-07 11:05:47.520539: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x87c8310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-07 11:05:47.520554: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-07 11:05:47.631550: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.632359: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x8460e50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-07 11:05:47.632375: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1070 with Max-Q Design, Compute Capability 6.1
2020-09-07 11:05:47.632579: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.632848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce GTX 1070 with Max-Q Design computeCapability: 6.1
coreClock: 1.2655GHz coreCount: 16 deviceMemorySize: 7.93GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-07 11:05:47.632902: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-09-07 11:05:47.632935: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-09-07 11:05:47.632962: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-07 11:05:47.632987: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-07 11:05:47.633013: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-07 11:05:47.633039: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-09-07 11:05:47.633065: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-09-07 11:05:47.633129: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.633433: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.633684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-07 11:05:47.633726: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-09-07 11:05:47.964768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-07 11:05:47.964797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2020-09-07 11:05:47.964803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2020-09-07 11:05:47.965072: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.965478: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-07 11:05:47.965794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7435 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070 with Max-Q Design, pci bus id: 0000:01:00.0, compute capability: 6.1)
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/sympy/core/compatibility.py", line 419, in as_int
    raise TypeError
TypeError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "biholoNN_exp_50_100_200.py", line 30, in <module>
    train_set = generate_dataset(HS)
  File "/home/mdouglas/Manifold/biholoNN.py", line 86, in generate_dataset
    new_dataset = dataset_on_patch(subpatch)
  File "/home/mdouglas/Manifold/biholoNN.py", line 98, in dataset_on_patch
    patch.restriction = patch.get_restriction(lambdify=True)
  File "/home/mdouglas/Manifold/hypersurface_tf.py", line 352, in get_restriction
    restriction = local_coordinates.jacobian(affine_coordinates).inv()
  File "/usr/lib/python3/dist-packages/sympy/matrices/matrices.py", line 3672, in inv
    return self._eval_inverse(**kwargs)
  File "/usr/lib/python3/dist-packages/sympy/matrices/dense.py", line 265, in _eval_inverse
    rv = M.inverse_GE(iszerofunc=iszerofunc)
  File "/usr/lib/python3/dist-packages/sympy/matrices/matrices.py", line 3585, in inverse_GE
    red = big.rref(iszerofunc=iszerofunc, simplify=True)[0]
  File "/usr/lib/python3/dist-packages/sympy/matrices/matrices.py", line 941, in rref
    ret, pivot_cols = self._eval_rref(iszerofunc=iszerofunc,
  File "/usr/lib/python3/dist-packages/sympy/matrices/matrices.py", line 593, in _eval_rref
    reduced, pivot_cols, swaps = self._row_reduce(iszerofunc, simpfunc,
  File "/usr/lib/python3/dist-packages/sympy/matrices/matrices.py", line 713, in _row_reduce
    assumed_nonzero, newly_determined = _find_reasonable_pivot(
  File "/usr/lib/python3/dist-packages/sympy/matrices/matrices.py", line 5305, in _find_reasonable_pivot
    simped = simpfunc(x)
  File "/usr/lib/python3/dist-packages/sympy/simplify/simplify.py", line 559, in simplify
    original_expr = expr = collect_abs(signsimp(expr))
  File "/usr/lib/python3/dist-packages/sympy/simplify/simplify.py", line 383, in signsimp
    e = sub_post(sub_pre(expr))
  File "/usr/lib/python3/dist-packages/sympy/simplify/cse_opts.py", line 16, in sub_pre
    adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
  File "/usr/lib/python3/dist-packages/sympy/simplify/cse_opts.py", line 16, in <listcomp>
    adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
  File "/usr/lib/python3/dist-packages/sympy/core/expr.py", line 2386, in could_extract_minus_sign
    (negative_self).extract_multiplicatively(-1) is not None)
  File "/usr/lib/python3/dist-packages/sympy/core/expr.py", line 2208, in extract_multiplicatively
    newarg = arg.extract_multiplicatively(c)
  File "/usr/lib/python3/dist-packages/sympy/core/expr.py", line 2221, in extract_multiplicatively
    newarg = arg.extract_multiplicatively(c)
  File "/usr/lib/python3/dist-packages/sympy/core/expr.py", line 2134, in extract_multiplicatively
    elif c == self:
  File "/usr/lib/python3/dist-packages/sympy/core/numbers.py", line 2248, in __eq__
    return Rational.__eq__(self, other)
  File "/usr/lib/python3/dist-packages/sympy/core/numbers.py", line 1906, in __eq__
    integer_log(self.p//m, 2) == (t, True)
  File "/usr/lib/python3/dist-packages/sympy/core/power.py", line 147, in integer_log
    y = as_int(y)
  File "/usr/lib/python3/dist-packages/sympy/core/compatibility.py", line 425, in as_int
    raise ValueError('%s is not an integer' % (n,))
ValueError: -1 is not an integer
